<h1>注文情報確認</h1>
<table>
  <tr>
    <th>商品名</th>
    <th>単価(税込)</th>
    <th>数量</th>
    <th>小計</th>
  </tr>
  <tr>
    <% @cart_items .each do |cart_item| %>
    <td><%= attachment_image_tag cart_item.item, :image, format: 'jpeg', size: "40x40" %>
        <%= cart_item.item.name %></td>
    <td><%= number_to_currency((cart_item.item.price * 1.1).floor, :unit => "", :precision => 0) %></td>
    <td><%= cart_item.amount %></td>
    <td><%= number_to_currency((cart_item.item.price * 1.1).floor * cart_item.amount,
            :unit => "", :precision => 0) %></td>
    <td><% @total_product_price = @sub_total_product_price += (cart_item.item.price * 1.1).floor * cart_item.amount  %></td>
    <% end %>
  </tr>
</table>
<table>
  <tr>
    <th>送料</th>
    <th>商品合計</th>
    <th>請求金額</th>
  </tr>
  <tr>
    <td><%= number_to_currency(@shipping_cost, :unit => "", :precision => 0) %></td>
    <td><%= number_to_currency(@total_product_price, :unit => "", :precision => 0) %></td>
    <td><% @total_payment = @total_product_price + @shipping_cost %>
        <%= number_to_currency(@total_payment, :unit => "", :precision => 0) %></td>
  </tr>
</table>

<h1>支払い方法</h1>
<%= @order.payment_method %>
<h1>お届け先</h1>
<% @order.customer_id %>
<%= @order.postal_code %>
<%= @order.address %>
<%= @order.name %>

<%= form_with model: @order, local:true do |f| %>
<%= f.hidden_field :customer_id, :value => @order.customer_id  %>
<%= f.hidden_field :postal_code, :value => @order.postal_code %>
<%= f.hidden_field :address, :value => @order.address %>
<%= f.hidden_field :name, :value => @order.name %>
<%= f.hidden_field :shipping_cost, :value => @shipping_cost %>
<%= f.hidden_field :total_payment, :value => @total_payment %>
<%= f.hidden_field :payment_method, :value => @order.payment_method %>
<%= f.submit "注文を確定する" %>
<% end %>